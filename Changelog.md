Complete rewrite of the mod!